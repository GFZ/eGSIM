# Register here all supported flatfile columns and their metadata which will be used to
# perform flatfile IO operations. The syntax for each column (in YAML) is:
#
# <column_name>:
#   dtype:    The data type (default when missing: null). Supported values are: null,
#             int, float, str, datetime (ISO formatted), bool, or the list of the
#             possible values of the column data (which must be all the same dtype).
#             null or missing means "not specified" and will skip data type checks.
#             The dtype determines also how to fill missing data (e.g.: an empty CSV
#             cell. See `default` below for details), whereas data that is not parsable
#             to the given dtype (e.g.: 'x' for float) will always raise Exceptions
#   default:  The default value to replace missing data (e.g. '', null, NaN). When a
#             default is not provided, it will be `dtype` dependent: NaN (for dtype
#             float), NaT (datetime), None/null (str or categorical), 0 (int), False
#             (bool). As such, please note that int and bool do not really support
#             missing data, as 0 and False also denote valid values for the dtype
#   alias:    The column alias(es), as string or list of strings. You can put here
#             any additional name, e.g. the OpenQuake name (either parameter or distance)
#             related to <column_name>, if the two differ.
#             Columns of type i (intensity measure) cannot have aliases
#   type:     The column type. Supported values are: i (intensity measure), d
#             (distance measure), r (rupture parameter), s (site parameter).
#             When missing, defaults to 'u' (unknown). In the first 4 cases,
#             <column_name> (or one name defined in alias>) must match the relative
#             OpenQuake implementation.
#   required: Tells if the column should be always present in flatfile (default when
#             missing: false)
#   help:     The field help or description. Depending on the application, a default
#             might be provided (e.g. "")
#   ">"       (with quotation marks because > and < are special characters in YAML)
#             The minimum value (endpoint excluded) of the column data. Currently used
#             for info and not to validate or discard data (it might be in the future)
#   ">="      The min. value (endpoint included) of the column data (see ">" for details)
#   "<"       The max. value (endpoint excluded) of the column data (see ">" for details)
#   "<="      The max. value (endpoint included) of the column data (see ">" for details)

# YAML notes:
# Date-times can be given as ISO formatted text, without quotes. Unless required,
# strings don't need quotes either, but can be used for readability. YAML is a
# superset of JSON, so you can type lists as JSON Arrays: [...] and Mappings as JSON
# Objects: {...}. If you want to type over multiple lines for readability, prefix the
# text with >- (see examples here below or at https://stackoverflow.com/a/3790497)

azimuth:
  dtype: float
  type: d
repi:
  dtype: float
  help: epicentral distance (in km)
  type: d
rrup:
  dtype: float
  help: >-
    rupture_distance (in km). Missing data (empty or NaN values, column not provided) 
    will be replaced with the hypocentral distance, if the column "rhypo" 
    is provided
  type: d
rjb:
  dtype: float
  help: >-
    Joyner-Boore distance (in km). Missing data (empty or NaN values, column not provided)  
    will be replaced with the epicentral distance, if the column "repi" is provided
  type: d
rhypo:
  dtype: float
  help: hypocentral distance (in km)
  type: d
rx:
  dtype: float
  help: >-
    Horizontal distance (in km) from the top of the rupture measured perpendicular to 
    strike. Missing data (empty or NaN values, column not provided) will be replaced 
    with the epicentral distance, if the column "repi" is provided
  type: d
ry0:
  dtype: float
  help: >-
    Horizontal distance (in km) from the top of the rupture measured parallel to strike. 
    Missing data (empty or NaN values, column not provided) will be replaced with the 
    epicentral distance, if the column "repi" is provided
  type: d
rvolc:
  dtype: float
  default: 0
  help: Distance through volcanic zone (km). When missing, it defaults to 0
  type: d
ev_lat:
  dtype: float
  ">=": -90
  "<=": 90
  help: Event latitude (hypocentre latitude, in deg)
  alias: [hypo_lat, event_latitude]
  type: r
ev_lon:
  dtype: float
  ">=": -180
  "<=": 180
  help: Event longitude (hypocentre longitude, in deg)
  alias: [hypo_lon, event_longitude]
  type: r
mag:
  dtype: float
  alias: magnitude
  help: event magnitude
  type: r
  required: true
ev_depth:
  dtype: float
  help: event depth (hypocentral depth, in km)
  alias: [hypo_depth, event_depth]
  type: r
rupture_top_depth:
  dtype: float
  ">=": 0
  help: Top of Rupture Depth (km)
  alias: [ztor, depth_top_of_rupture]
  type: r
rupture_width:
  dtype: float
  ">=": 0
  help: >-
    Down-dip width of the rupture (km). Missing data (empty or NaN values, column not 
    provided) will be derived from the record magnitude using a Magnitude-Scaling 
    Relationship defined for PEER PSHA test cases, and assuming an aspect ratio of 1
  alias: width
  type: r
dip:
  dtype: float
  ">=": 0
  "<=": 90
  help: >-
    the angle of the fault relative to the horizontal (deg).
    Hint: in case of more components available (e.g. from web services), the
    correct one should be inferred by the user from the rupture, or can be chosen
    randomly if no information is available
  type: r
rake:
  dtype: float
  ">=": -180
  "<=": 180
  help: >-
    the direction the hanging wall moves, relative to the fault strike (deg).
    Hint: in case of more components available (e.g. from
    web services), the correct one should be inferred by the user from the rupture,
    or can be chosen randomly if no information is available
  type: r
z1pt0:
  dtype: float
  help: >-
    depth of the layer where seismic waves start to propagate with a speed above 1.0 
    km/sec, in meters. Missing data (empty or NaN values, column not provided) will be 
    derived from the record vs30 using the Chiou & Youngs (2014) California model, if 
    the flatfile column "vs30" is provided
  alias: z1
  type: s
z2pt5:
  dtype: float
  help: >-
    depth of the layer where seismic waves start to propagate with a speed above 
    2.5 km/sec, in km. Missing data (empty or NaN values, column not provided) will be 
    derived from the record vs30 using the Campbell & Bozorgnia (2014) model, if the 
    flatfile column "vs30" is provided
  type: s
vs30:
  dtype: float
  ">=": 0
  help: Average shear wave velocity in the top 30 m, in m/s
  type: s
backarc:
  dtype: bool
  default: false
  type: s
  help: >-
    boolean indicating if the site is in the subduction backarc. When missing or false, 
    the site is assumed to be unknown or in the subduction forearc
st_lat:
  dtype: float
  ">=": -90
  "<=": 90
  help: station latitude (deg)
  alias: [station_latitude, lat]
  type: s
st_lon:
  dtype: float
  ">=": -180
  "<=": 180
  help: station longitude (deg)
  alias: [station_longitude, lon]
  type: s
vs30measured:
  dtype: bool
  default: true
  help: whether or not the Vs30 is measured (default true)
  type: s
xvf:
  dtype: float
  help: distance to the volcanic front (km)
  type: s
fpeak:
  dtype: float
  ">=": 0
  help: >-
    Frequency that corresponds to the peak of the horizontal to vertical
    spectral ratio (Hz)
  type: s
region:
  dtype: int
  ">=": 0
  "<=": 5
  default: 0
  help: The ESHM2020 cluster region to which the site belongs
  type: s
geology:
  dtype: ["CENOZOIC", "HOLOCENE", "JURASSIC-TRIASSIC", "CRETACEOUS", "PALEOZOIC", "PLEISTOCENE", "PRECAMBRIAN", "UNKNOWN"]
  default: UNKNOWN
  help: geological classification of the site
  type: s
slope:
  dtype: float
  ">": 0
  help: The local slope of the station
  type: s
PGA:
  dtype: float
  help: Peak ground acceleration, in g
  type: i
PGV:
  dtype: float
  help: Peak ground velocity, in cm/s
  type: i
SA:
  dtype: float
  help: >-
    Spectral Acceleration, in g. SA columns are in the form "SA(P)",
    where P denotes the period at which it has been computed, in s
  type: i
PGD:
  dtype: float
  help: Peak ground displacement during an earthquake measured, in cm
  type: i
CAV:
  dtype: float
  help: Cumulative Absolute Velocity, in g-sec
  type: i
IA:
  dtype: float
  help: Arias intensity, in m/s
  type: i
# ID columns:
ev_id:
  alias: event_id
  help: >-
    The unique ID of the recorded seismic event. If missing, an id is inferred
    from the columns event_latitude, event_longitude, event_depth and event_time 
    (ISO date time), which must all be present.
    In general, you can use the id provided by the event catalog or web service,
    or create your own, as long as it holds: same id <=> same event. IDs should
    be preferably of type integer for performance reasons
st_id:
  alias: station_id
  help: >-
    The unique ID of the seismic station. If missing, an id is inferred
    from the columns station_latitude, station_longitude, which must all be present.
    In general, you can infer the id via the tuple (network_code, station_code)
    or create your own, as long as it holds: same id <=> same station. IDs should
    be preferably of type integer for performance reasons
ev_time:
  alias: event_time
  dtype: datetime
  help: the event time (as ISO formatted string, e.g. 2006-03-31T00:12:24)


# FIXME: REMOVE:

# Here the collection of the parameters required by all OpenQuake models, mapped to their
# corresponding flatfile column. With this information programs can tell, for any given
# flatfile, which Ground motion models can be used with it. **As such, a parameter with
# no mapping (or mapped to null) will programmatically discard all models requiring it**.

#openquake_models_parameters:
#  distance_measure:  # OpenQuake model attribute: REQUIRES_DISTANCES
#    azimuth: azimuth
#    repi: repi
#    rrup: rrup
#    rjb: rjb
#    rhypo: rhypo
#    rx: rx
#    ry0: ry0
#    rvolc: rvolc
#    rcdpp:
#  rupture_parameter:  # OpenQuake model attribute: REQUIRES_RUPTURE_PARAMETERS
#    hypo_lat: event_latitude
#    hypo_lon: event_longitude
#    hypo_depth: event_depth
#    mag: magnitude
#    ztor: depth_top_of_rupture
#    width: rupture_width
#    dip: dip
#    rake: rake
#    in_cshm:
#  site_parameter:  # OpenQuake model attribute: REQUIRES_SITES_PARAMETERS
#    z1pt0: z1
#    z2pt5: z2pt5
#    vs30: vs30
#    backarc: backarc
#    lat: station_latitude
#    lon: station_longitude
#    vs30measured: vs30measured
#    xvf: xvf
#    fpeak: fpeak
#    region: region
#    geology: geology
#    slope: slope
#    f0:
#    z1pt4:
#    ec8_p18:
#    bas:
#    siteclass:
#    h800:
#    ec8:
#    soiltype:
#    THV:
#    PHV:
#    T_15:
#    F_15:
#    D50_15:
#    freeface_ratio:
{% extends 'base_vue.html' %}

{% block head %}
	{% with plotly=True axios=True %}
		{{ block.super }}
	{% endwith %}
{% endblock %}
	
{% block main %}

	<div class='position-absolute pos-0 m-0 flex-direction-row justify-content-center'> <!-- p-3: padding=1rem -->
	
		<!-- trellisfiv first, as it has automatically a greater z-index -->
		<trellisdiv v-bind:eventbus="eventbus" url='get_trellis_plots'
			class='position-absolute pos-0 m-0 flex-direction-row pl-2'>
		</trellisdiv>
	
		<trellisform id='egsim-form' name='egsim-form' url='get_trellis_plots'
			submit_element_id='{{ form.plot_type.auto_id }}'
			v-bind:eventbus="eventbus"
			class='flex-direction-col m-3 p-2'>

			<div class='flexible flex-direction-col' slot-scope='formscope'>

				<div class='flexible flex-direction-row'>

					<div id='inputsel' class="flexible flex-direction-col p-2">
						
						<gsimselect class='flexible'
							name="{{ form.gsim.html_name }}"
							showfilter
							v-bind:errormsg="formscope.fielderrors['{{ form.gsim.html_name }}']"
							v-bind:avalgsims="avalGsims"
							v-bind:selectedgsims.sync="selectedGsims">
							{{ form.gsim.label }}
						</gsimselect>
						
						<imtselect
							name="{{ form.imt.html_name }}"
							v-bind:errormsg="formscope.fielderrors['{{ form.imt.html_name }}']"
							v-bind:avalgsims="avalGsims"
							v-bind:selectedgsims="selectedGsims"
							v-bind:avalimts="avalImts"
							v-bind:selectedimts.sync="selectedImts">
							{{ form.imt.label }}
						</imtselect>

					</div>
					
					<div id='rupture' class='flexible p-2' >
						{% for field in form.visible_fields %}
							{% if field.html_name != form.plot_type.html_name %}

							<div class="mr-2">
								{{ field.html_name }}<errorspan v-bind:text="formscope.fielderrors['{{ field.html_name }}']"></errorspan>
							</div>

							<div>{{ field }}</div>

							<div class="text-muted small text-nowrap mb-2 field-help">
							{% if field.html_name|lower != field.label|lower %}
								{{ field.label }}{% if field.help_text %}: {% endif %}
							{% endif %}
							{{ field.help_text }}
							</div>

							{% endif %}
						{% endfor %}

					</div>

				</div>

				<div class='p-2 flex-direction-row'>
					<!-- the submit button is the plot_type field. See Vuw component where we attach the submit
					functionality -->
					<div>
						{{ form.plot_type.label }}
					</div>
					<div class=flexible>
						{{ form.plot_type }}
					</div>
				</div>

			</div>

		</trellisform>

	</div>
{% endblock %}


{% block after-body %}

<script type='text/javascript' src = "{% static 'js/components/errorspan.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/gsimselect.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/imtselect.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/egsimform.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/trellisform.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/trellisdiv.js' %}"></script>

{{ block.super }}
 
{% endblock %}

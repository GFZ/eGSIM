{% extends 'base_vue.html' %}

{% block head %}
	{% with plotly=True %}
		{{ block.super }}
	{% endwith %}
{% endblock %}
	
{% block main %}

	<div class='position-absolute pos-0 m-0 flex-direction-row justify-content-center'> <!-- p-3: padding=1rem -->

		<residualsdiv v-bind:eventbus="eventbus" url='{{ post_url }}'
			class='position-absolute pos-0 m-0 flex-direction-row' style='z-index:1'>
			<div slot-scope='divscope'>
                <button @click="divscope.eventbus.$emit(divscope.url + ':form:show')"
                	class='btn btn-outline-dark'>params</button> <!-- show form below -->
            </div>
		</residualsdiv>
	
		<modalform url='{{ post_url }}'
			v-bind:eventbus="eventbus"
			class='flex-direction-col m-2 p-4' style='z-index:10'>

			<div class='flexible flex-direction-col' slot-scope='formscope'>

				<div class='flexible flex-direction-row'>

					<gsimselect class='flexible p-1'
								name="{{ form.gsim.html_name }}"
								showfilter
								v-bind:errormsg="formscope.fielderrors['{{ form.gsim.html_name }}']"
								v-bind:avalgsims="avalGsims"
								v-bind:selectedgsims.sync="selectedGsims">
								{{ form.gsim.label }}
					</gsimselect>
							
					<div class='flexible flex-direction-col ml-4'>

							<imtselect class='flexible p-1 mb-4'
								name="{{ form.imt.html_name }}"
								v-bind:errormsg="formscope.fielderrors['{{ form.imt.html_name }}']"
								v-bind:avalgsims="avalGsims"
								v-bind:selectedgsims="selectedGsims"
								v-bind:avalimts="avalImts"
								v-bind:selectedimts.sync="selectedImts">
								{{ form.imt.label }}
							</imtselect>

							<div class='p-1'>
							
				  				<h5>{{ form.gmdb.label }}</h5>

								<div class="grid-2-columns grid-col-gap-2 grid-row-gap-1">
					
									<div class="grid-col-span">{{ form.gmdb }}</div>
									<errorspan class="grid-col-span"
										:text="formscope.fielderrors['{{ form.gmdb.html_name }}']"></errorspan>
				
									{{ form.selection.label_tag }} {{ form.selection }}
									<errorspan class="grid-col-span"
										:text="formscope.fielderrors['{{ form.selection.html_name }}']"></errorspan>
					
									{{ form.selection_min.label_tag }} {{ form.selection_min }}
									<errorspan class="grid-col-span"
										:text="formscope.fielderrors['{{ form.selection_min.html_name }}']"></errorspan>
					
									{{ form.selection_max.label_tag }} {{ form.selection_max }}
									<errorspan class="grid-col-span"
										:text="formscope.fielderrors['{{ form.selection_max.html_name }}']"></errorspan>
					
									{{ form.distance_type.label_tag }} {{ form.distance_type }}
									<errorspan class="grid-col-span"
										:text="formscope.fielderrors['{{ form.distance_type.html_name }}']"></errorspan>
									
								</div>
							</div> 
						
					</div>

				</div>

				<div class='flex-direction-row mt-3'>
					<!-- the submit button is the plot_type field. Render manually -->
					{{ form.plot_type.label_tag }}
					<select class='form-control flexible mr-3 ml-1' size="4" name="{{ form.plot_type.html_name }}"
						id="{{ form.plot_type.auto_id }}">
    					{% for choice in form.plot_type.field.choices %}
        				<option value="{{ choice.0 }}">{{ choice.1 }}</option>
    					{% endfor %}
					</select>
					<button type="submit" class='btn btn-outline-primary'>
		            	Display plots
		        	</button>
				</div>

				<!-- <div class="flex-direction-row mb-4">
					{{ form.plot_type.label_tag }}
					<select class='form-control flexible ml-1' size="4" name="{{ form.plot_type.html_name }}"
						id="{{ form.plot_type.auto_id }}">
						{% for choice in form.plot_type.field.choices %}
	    				<option value="{{ choice.0 }}">{{ choice.1 }}</option>
						{% endfor %}
					</select>
				</div>
				
				<button type="submit" class='btn btn-outline-primary'>
		            Display residuals
		        </button> -->
			</div>

		</modalform>

	</div>
{% endblock %}


{% block after-body %}

<script type='text/javascript' src = "{% static 'js/components/errorspan.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/gsimselect.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/imtselect.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/egsimform.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/modalform.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/plotsdiv.js' %}"></script>
<script type='text/javascript' src = "{% static 'js/components/residualsdiv.js' %}"></script>

{{ block.super }}
 
{% endblock %}
